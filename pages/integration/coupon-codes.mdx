# Coupon Codes

For StopChurn to be able to include coupon codes generated by clients API inside of notifications templates, we have implemented callbacks for this purpose. Every Coupon Code first must be created on the Back Office platform.

## Coupon code callbacks

Each brand have Coupon Code Endpoint property and all callbacks are being sent to that endpoint.
The <a href="https://stopchurn-docs.vercel.app/integration/callbacks#payload-signature" target="_blank" rel="noopener noreferrer" style={{ textDecoration: 'underline', fontStyle: 'italic' }}>payload signature</a> security method is implemented for every callback.

The coupon code "data" is consisted of:
- `userId` - ID of the user which will receive the coupon code. 
- `couponId` - ID of the coupon code defined on the StopChurn Back Office.
- `couponProperties` - Properties and values of a Coupon Code. Properties are defined in the Coupon Code section of the Back Office and values are defined in journeys.

### Coupon code callback data example

```json
{
  "data": {
    "userId": "550e8400-e29b-41d4-a716-446655440000",
    "couponId": "testCoupon123",
    "couponProperties": {
      "stringProp": "dummy string",
      "numberProp": 123,
      "dateProp": 1704063600000,
      "numberArrayProp": [10, 20, 30]
    }
  },
  "signature": "e76ff7c60b30e74a370a6628c9844a0789af05aa3ee2b376baa0484eb505136da9902764eacc43cbf61908735a9408d77dd1c004a6b2ec4bb77e80c83c726877"
}

```

## Coupon Code callback responses

The generated coupon code you want to include inside of notification template should be placed inside of "couponCodeValue" field of the callback response.

### Valid Coupon Code callback response data examples

```json
{
  "couponCodeValue": "BONUS25PERCENT11234"
}

```

```json
{
  "dummyProperty1": "dummyValue1",
  "couponCodeValue": "BONUS25PERCENT11234",
  "dummyProperty2": 123
}

```

